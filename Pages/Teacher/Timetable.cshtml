@page
@model SchoolGradebook.Pages.Teacher.TimetableModel
@using SchoolGradebook.Services
@using System.Globalization;
@{
    ViewData["Title"] = "Rozvrh hodin";
    string[] days = { "Pondělí", "Úterý", "Středa", "Čtvrtek", "Pátek" };
    System.Threading.Thread.CurrentThread.CurrentCulture = CultureInfo.GetCultureInfo("cs-CZ");
    DateTime firstDayOfTermStartWeek = Model.TermStart.AddDays(-(int)Model.TermStart.DayOfWeek);
}
<p class="table-heading">
    Týden @firstDayOfTermStartWeek.AddDays((Model.Timetable.Week * 7) + 1).ToShortDateString() - @firstDayOfTermStartWeek.AddDays((Model.Timetable.Week + 1) * 7).ToShortDateString()
</p>
@if (Model.DisplayModeRow == null || Model.DisplayModeRow == false)
{
    <div class="timetable box-shadow">
        <input hidden type="checkbox" id="displayModeRow">
        @for (int i = 0; i < Model.TimeFramesByDay.Length; i++)
        {
            <div class="tt-day-group">
                <div class="timeframe-day">@days[i]</div>

                @foreach (var tf in Model.TimeFramesByDay[i])
                {
                    if (tf.TimetableRecord != null)
                    {
                        var si = tf.TimetableRecord.SubjectInstance;
                        <div class="timeframe">
                            @tf.Start.ToString("h:mm") - @tf.End.ToString("h:mm")<br>
                            <strong>
                                @(LanguageHelper.getShorterString(si.SubjectType.Name, 99))
                            </strong><br>
                            @foreach (var enrollment in si.Enrollments)
                            {
                                @(enrollment.StudentGroup.GetName() + ",")
                            }
                            @tf.TimetableRecord.Room.Name<br>
                        </div>
                    }
                    else
                    {
                        <div class="timeframe timeframe-blank">
                            @tf.Start.ToString("h:mm") - @tf.End.ToString("h:mm")
                        </div>
                    }

                }
            </div>
        }
    </div>
}
else
{<div class="timetable box-shadow flex-column">
        <input hidden type="checkbox" id="displayModeRow" checked>
        @for (int i = 0; i < Model.TimeFramesByDay.Length; i++)
        {
            <div class="tt-day-group d-flex flex-row">
                <div class="timeframe-day tt-width-5">@days[i]</div>

                @foreach (var tf in Model.TimeFramesByDay[i])
                {
                    if (tf.TimetableRecord != null)
                    {
                        var si = tf.TimetableRecord.SubjectInstance;
                        <div class="timeframe tt-width-5">
                            @tf.Start.ToString("h:mm") - @tf.End.ToString("h:mm")<br>
                            <strong>
                                @(LanguageHelper.getShorterString(si.SubjectType.Name, 99))
                            </strong><br>
                            @foreach (var enrollment in si.Enrollments)
                            {
                                @(enrollment.StudentGroup.GetName() + ",")
                            }
                            @tf.TimetableRecord.Room.Name<br>
                        </div>
                    }
                    else
                    {
                        <div class="timeframe timeframe-blank tt-width-5">
                            @tf.Start.ToString("h:mm") - @tf.End.ToString("h:mm")
                        </div>
                    }

                }
            </div>
        }
    </div>
}

